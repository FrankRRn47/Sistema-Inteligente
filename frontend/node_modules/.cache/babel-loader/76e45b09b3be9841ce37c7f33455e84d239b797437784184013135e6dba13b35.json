{"ast":null,"code":"import api, { API_BASE_URL } from './api.js';\nfunction normalizeFileEndpoint(pathOrUrl) {\n  if (!pathOrUrl) {\n    return null;\n  }\n  const withoutBase = pathOrUrl.startsWith('http') ? pathOrUrl.replace(API_BASE_URL, '') : pathOrUrl;\n  if (withoutBase.startsWith('/media/files')) {\n    return withoutBase;\n  }\n  const sanitized = withoutBase.replace(/^\\/+/, '');\n  return `/media/files/${sanitized}`;\n}\nfunction normalizeAnalysesPayload(data = {}) {\n  const analyses = Array.isArray(data.analyses) ? data.analyses : data.analysis ? [data.analysis] : [];\n  const normalized = {\n    ...data,\n    analyses\n  };\n  if (!normalized.analysis && analyses.length > 0) {\n    normalized.analysis = analyses[0];\n  }\n  return normalized;\n}\nfunction sendMultipart(endpoint, file, channel = 'manual', extraFields = {}) {\n  const formData = new FormData();\n  formData.append('file', file);\n  formData.append('channel', channel);\n  Object.entries(extraFields).forEach(([key, value]) => {\n    if (value !== undefined && value !== null && value !== '') {\n      formData.append(key, value);\n    }\n  });\n  return api.post(endpoint, formData, {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  });\n}\nexport async function analyzeImageUpload(file, channel = 'manual') {\n  const {\n    data\n  } = await sendMultipart('/analyze-imagen', file, channel);\n  return normalizeAnalysesPayload(data);\n}\nexport async function analyzeVideoUpload(file, channel = 'manual') {\n  const {\n    data\n  } = await sendMultipart('/analyze-video', file, channel);\n  return normalizeAnalysesPayload(data);\n}\nexport async function analyzeWebcamUpload(file, channel = 'webcam') {\n  const {\n    data\n  } = await sendMultipart('/analyze-webcam', file, channel);\n  return normalizeAnalysesPayload(data);\n}\nexport async function analyzeWebcamFrame(file, channel = 'webcam-live', sessionId) {\n  const extraFields = sessionId ? {\n    session_id: sessionId\n  } : {};\n  const {\n    data\n  } = await sendMultipart('/analyze-webcam-frame', file, channel, extraFields);\n  return data;\n}\nexport async function startLiveSession(channel = 'webcam-live') {\n  const {\n    data\n  } = await api.post('/media/live-session/start', {\n    channel\n  });\n  return data;\n}\nexport async function stopLiveSession(sessionId) {\n  const {\n    data\n  } = await api.post('/media/live-session/stop', {\n    session_id: sessionId\n  });\n  return normalizeAnalysesPayload(data);\n}\nexport async function fetchModelMetadata() {\n  const {\n    data\n  } = await api.get('/media/model-metadata');\n  return data;\n}\nexport async function fetchMediaHistory({\n  limit = 12,\n  mediaType,\n  sourceType,\n  emotion\n} = {}) {\n  const params = {\n    limit\n  };\n  if (mediaType && mediaType !== 'all') {\n    params.media_type = mediaType;\n  }\n  if (sourceType && sourceType !== 'all') {\n    params.source_type = sourceType;\n  }\n  if (emotion && emotion !== 'all') {\n    params.emotion = emotion;\n  }\n  const {\n    data\n  } = await api.get('/media/records', {\n    params\n  });\n  return data;\n}\nexport async function fetchMediaSnapshot(pathOrUrl) {\n  const endpoint = normalizeFileEndpoint(pathOrUrl);\n  if (!endpoint) {\n    return null;\n  }\n  const response = await api.get(endpoint, {\n    responseType: 'blob'\n  });\n  return response.data;\n}","map":{"version":3,"names":["api","API_BASE_URL","normalizeFileEndpoint","pathOrUrl","withoutBase","startsWith","replace","sanitized","normalizeAnalysesPayload","data","analyses","Array","isArray","analysis","normalized","length","sendMultipart","endpoint","file","channel","extraFields","formData","FormData","append","Object","entries","forEach","key","value","undefined","post","headers","analyzeImageUpload","analyzeVideoUpload","analyzeWebcamUpload","analyzeWebcamFrame","sessionId","session_id","startLiveSession","stopLiveSession","fetchModelMetadata","get","fetchMediaHistory","limit","mediaType","sourceType","emotion","params","media_type","source_type","fetchMediaSnapshot","response","responseType"],"sources":["C:/Users/Loq/Desktop/gatoportafolio/Beta01/SIMPACBETA/frontend/src/services/mediaService.js"],"sourcesContent":["import api, { API_BASE_URL } from './api.js';\r\n\r\nfunction normalizeFileEndpoint(pathOrUrl) {\r\n  if (!pathOrUrl) {\r\n    return null;\r\n  }\r\n  const withoutBase = pathOrUrl.startsWith('http')\r\n    ? pathOrUrl.replace(API_BASE_URL, '')\r\n    : pathOrUrl;\r\n  if (withoutBase.startsWith('/media/files')) {\r\n    return withoutBase;\r\n  }\r\n  const sanitized = withoutBase.replace(/^\\/+/, '');\r\n  return `/media/files/${sanitized}`;\r\n}\r\n\r\nfunction normalizeAnalysesPayload(data = {}) {\r\n  const analyses = Array.isArray(data.analyses)\r\n    ? data.analyses\r\n    : data.analysis\r\n    ? [data.analysis]\r\n    : [];\r\n  const normalized = { ...data, analyses };\r\n  if (!normalized.analysis && analyses.length > 0) {\r\n    normalized.analysis = analyses[0];\r\n  }\r\n  return normalized;\r\n}\r\n\r\nfunction sendMultipart(endpoint, file, channel = 'manual', extraFields = {}) {\r\n  const formData = new FormData();\r\n  formData.append('file', file);\r\n  formData.append('channel', channel);\r\n  Object.entries(extraFields).forEach(([key, value]) => {\r\n    if (value !== undefined && value !== null && value !== '') {\r\n      formData.append(key, value);\r\n    }\r\n  });\r\n  return api.post(endpoint, formData, {\r\n    headers: { 'Content-Type': 'multipart/form-data' },\r\n  });\r\n}\r\n\r\nexport async function analyzeImageUpload(file, channel = 'manual') {\r\n  const { data } = await sendMultipart('/analyze-imagen', file, channel);\r\n  return normalizeAnalysesPayload(data);\r\n}\r\n\r\nexport async function analyzeVideoUpload(file, channel = 'manual') {\r\n  const { data } = await sendMultipart('/analyze-video', file, channel);\r\n  return normalizeAnalysesPayload(data);\r\n}\r\n\r\nexport async function analyzeWebcamUpload(file, channel = 'webcam') {\r\n  const { data } = await sendMultipart('/analyze-webcam', file, channel);\r\n  return normalizeAnalysesPayload(data);\r\n}\r\n\r\nexport async function analyzeWebcamFrame(file, channel = 'webcam-live', sessionId) {\r\n  const extraFields = sessionId ? { session_id: sessionId } : {};\r\n  const { data } = await sendMultipart('/analyze-webcam-frame', file, channel, extraFields);\r\n  return data;\r\n}\r\n\r\nexport async function startLiveSession(channel = 'webcam-live') {\r\n  const { data } = await api.post('/media/live-session/start', { channel });\r\n  return data;\r\n}\r\n\r\nexport async function stopLiveSession(sessionId) {\r\n  const { data } = await api.post('/media/live-session/stop', { session_id: sessionId });\r\n  return normalizeAnalysesPayload(data);\r\n}\r\n\r\nexport async function fetchModelMetadata() {\r\n  const { data } = await api.get('/media/model-metadata');\r\n  return data;\r\n}\r\n\r\nexport async function fetchMediaHistory({ limit = 12, mediaType, sourceType, emotion } = {}) {\r\n  const params = { limit };\r\n  if (mediaType && mediaType !== 'all') {\r\n    params.media_type = mediaType;\r\n  }\r\n  if (sourceType && sourceType !== 'all') {\r\n    params.source_type = sourceType;\r\n  }\r\n  if (emotion && emotion !== 'all') {\r\n    params.emotion = emotion;\r\n  }\r\n  const { data } = await api.get('/media/records', { params });\r\n  return data;\r\n}\r\n\r\nexport async function fetchMediaSnapshot(pathOrUrl) {\r\n  const endpoint = normalizeFileEndpoint(pathOrUrl);\r\n  if (!endpoint) {\r\n    return null;\r\n  }\r\n  const response = await api.get(endpoint, { responseType: 'blob' });\r\n  return response.data;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useMemo, useState } from 'react';\nimport { API_BASE_URL } from '../services/api.js';\nimport { fetchMediaSnapshot } from '../services/mediaService.js';\nconst API_ROOT = API_BASE_URL.replace(/\\/$/, '');\nfunction buildAbsoluteUrl(path) {\n  if (!path) {\n    return null;\n  }\n  if (path.startsWith('http')) {\n    return path;\n  }\n  if (path.startsWith('/')) {\n    return `${API_ROOT}${path}`;\n  }\n  return `${API_ROOT}/${path}`;\n}\nexport default function useSnapshotPreview(snapshotPath) {\n  _s();\n  const [previewUrl, setPreviewUrl] = useState(null);\n  const [state, setState] = useState(snapshotPath ? 'loading' : 'idle');\n  const fallbackUrl = useMemo(() => buildAbsoluteUrl(snapshotPath), [snapshotPath]);\n  useEffect(() => {\n    let isMounted = true;\n    let objectUrl = null;\n    if (!snapshotPath) {\n      setPreviewUrl(null);\n      setState('idle');\n      return () => {};\n    }\n    setState('loading');\n    fetchMediaSnapshot(snapshotPath).then(blob => {\n      if (!blob || !isMounted) {\n        return;\n      }\n      objectUrl = URL.createObjectURL(blob);\n      setPreviewUrl(objectUrl);\n      setState('ready');\n    }).catch(() => {\n      if (isMounted) {\n        setState('error');\n      }\n    });\n    return () => {\n      isMounted = false;\n      if (objectUrl) {\n        URL.revokeObjectURL(objectUrl);\n      }\n    };\n  }, [snapshotPath]);\n  return {\n    previewUrl,\n    fallbackUrl,\n    state\n  };\n}\n_s(useSnapshotPreview, \"ho0U+PdIJXBAVTqqRTUcuiyrrsM=\");","map":{"version":3,"names":["useEffect","useMemo","useState","API_BASE_URL","fetchMediaSnapshot","API_ROOT","replace","buildAbsoluteUrl","path","startsWith","useSnapshotPreview","snapshotPath","_s","previewUrl","setPreviewUrl","state","setState","fallbackUrl","isMounted","objectUrl","then","blob","URL","createObjectURL","catch","revokeObjectURL"],"sources":["C:/Users/Loq/Desktop/gatoportafolio/EmocionesDos - versioncuatroedit01 - 100% funcional - vedit/SIMPACeditDos/frontend/src/hooks/useSnapshotPreview.js"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\r\n\r\nimport { API_BASE_URL } from '../services/api.js';\r\nimport { fetchMediaSnapshot } from '../services/mediaService.js';\r\n\r\nconst API_ROOT = API_BASE_URL.replace(/\\/$/, '');\r\n\r\nfunction buildAbsoluteUrl(path) {\r\n  if (!path) {\r\n    return null;\r\n  }\r\n  if (path.startsWith('http')) {\r\n    return path;\r\n  }\r\n  if (path.startsWith('/')) {\r\n    return `${API_ROOT}${path}`;\r\n  }\r\n  return `${API_ROOT}/${path}`;\r\n}\r\n\r\nexport default function useSnapshotPreview(snapshotPath) {\r\n  const [previewUrl, setPreviewUrl] = useState(null);\r\n  const [state, setState] = useState(snapshotPath ? 'loading' : 'idle');\r\n  const fallbackUrl = useMemo(() => buildAbsoluteUrl(snapshotPath), [snapshotPath]);\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    let objectUrl = null;\r\n\r\n    if (!snapshotPath) {\r\n      setPreviewUrl(null);\r\n      setState('idle');\r\n      return () => {};\r\n    }\r\n\r\n    setState('loading');\r\n    fetchMediaSnapshot(snapshotPath)\r\n      .then((blob) => {\r\n        if (!blob || !isMounted) {\r\n          return;\r\n        }\r\n        objectUrl = URL.createObjectURL(blob);\r\n        setPreviewUrl(objectUrl);\r\n        setState('ready');\r\n      })\r\n      .catch(() => {\r\n        if (isMounted) {\r\n          setState('error');\r\n        }\r\n      });\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      if (objectUrl) {\r\n        URL.revokeObjectURL(objectUrl);\r\n      }\r\n    };\r\n  }, [snapshotPath]);\r\n\r\n  return { previewUrl, fallbackUrl, state };\r\n}\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AAEpD,SAASC,YAAY,QAAQ,oBAAoB;AACjD,SAASC,kBAAkB,QAAQ,6BAA6B;AAEhE,MAAMC,QAAQ,GAAGF,YAAY,CAACG,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;AAEhD,SAASC,gBAAgBA,CAACC,IAAI,EAAE;EAC9B,IAAI,CAACA,IAAI,EAAE;IACT,OAAO,IAAI;EACb;EACA,IAAIA,IAAI,CAACC,UAAU,CAAC,MAAM,CAAC,EAAE;IAC3B,OAAOD,IAAI;EACb;EACA,IAAIA,IAAI,CAACC,UAAU,CAAC,GAAG,CAAC,EAAE;IACxB,OAAO,GAAGJ,QAAQ,GAAGG,IAAI,EAAE;EAC7B;EACA,OAAO,GAAGH,QAAQ,IAAIG,IAAI,EAAE;AAC9B;AAEA,eAAe,SAASE,kBAAkBA,CAACC,YAAY,EAAE;EAAAC,EAAA;EACvD,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EAClD,MAAM,CAACa,KAAK,EAAEC,QAAQ,CAAC,GAAGd,QAAQ,CAACS,YAAY,GAAG,SAAS,GAAG,MAAM,CAAC;EACrE,MAAMM,WAAW,GAAGhB,OAAO,CAAC,MAAMM,gBAAgB,CAACI,YAAY,CAAC,EAAE,CAACA,YAAY,CAAC,CAAC;EAEjFX,SAAS,CAAC,MAAM;IACd,IAAIkB,SAAS,GAAG,IAAI;IACpB,IAAIC,SAAS,GAAG,IAAI;IAEpB,IAAI,CAACR,YAAY,EAAE;MACjBG,aAAa,CAAC,IAAI,CAAC;MACnBE,QAAQ,CAAC,MAAM,CAAC;MAChB,OAAO,MAAM,CAAC,CAAC;IACjB;IAEAA,QAAQ,CAAC,SAAS,CAAC;IACnBZ,kBAAkB,CAACO,YAAY,CAAC,CAC7BS,IAAI,CAAEC,IAAI,IAAK;MACd,IAAI,CAACA,IAAI,IAAI,CAACH,SAAS,EAAE;QACvB;MACF;MACAC,SAAS,GAAGG,GAAG,CAACC,eAAe,CAACF,IAAI,CAAC;MACrCP,aAAa,CAACK,SAAS,CAAC;MACxBH,QAAQ,CAAC,OAAO,CAAC;IACnB,CAAC,CAAC,CACDQ,KAAK,CAAC,MAAM;MACX,IAAIN,SAAS,EAAE;QACbF,QAAQ,CAAC,OAAO,CAAC;MACnB;IACF,CAAC,CAAC;IAEJ,OAAO,MAAM;MACXE,SAAS,GAAG,KAAK;MACjB,IAAIC,SAAS,EAAE;QACbG,GAAG,CAACG,eAAe,CAACN,SAAS,CAAC;MAChC;IACF,CAAC;EACH,CAAC,EAAE,CAACR,YAAY,CAAC,CAAC;EAElB,OAAO;IAAEE,UAAU;IAAEI,WAAW;IAAEF;EAAM,CAAC;AAC3C;AAACH,EAAA,CAxCuBF,kBAAkB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
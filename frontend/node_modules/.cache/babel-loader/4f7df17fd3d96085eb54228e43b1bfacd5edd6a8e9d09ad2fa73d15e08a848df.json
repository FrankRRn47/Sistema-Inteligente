{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Loq\\\\Desktop\\\\gatoportafolio\\\\EmocionesDos - versioncuatroedit01\\\\SIMPACedit\\\\frontend\\\\src\\\\components\\\\MediaResultCard.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { API_BASE_URL } from '../services/api.js';\nimport { fetchMediaSnapshot } from '../services/mediaService.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MediaResultCard({\n  item\n}) {\n  _s();\n  var _item$detections, _item$media_type;\n  const baseUrl = API_BASE_URL.replace(/\\/$/, '');\n  const buildUrl = path => {\n    if (!path) return null;\n    if (path.startsWith('http')) return path;\n    return `${baseUrl}${path}`;\n  };\n  const snapshotHref = buildUrl(item.snapshot_url);\n  const originalHref = buildUrl(item.original_url);\n  const counts = Object.entries(((_item$detections = item.detections) === null || _item$detections === void 0 ? void 0 : _item$detections.counts) || {});\n  const [previewUrl, setPreviewUrl] = useState(null);\n  const [previewState, setPreviewState] = useState(item.snapshot_url ? 'loading' : 'idle');\n  useEffect(() => {\n    let isMounted = true;\n    let objectUrl = null;\n    if (!item.snapshot_url) {\n      setPreviewUrl(null);\n      setPreviewState('idle');\n      return () => {};\n    }\n    setPreviewState('loading');\n    fetchMediaSnapshot(item.snapshot_url).then(blob => {\n      if (!blob || !isMounted) {\n        return;\n      }\n      objectUrl = URL.createObjectURL(blob);\n      setPreviewUrl(objectUrl);\n      setPreviewState('ready');\n    }).catch(() => {\n      if (isMounted) {\n        setPreviewState('error');\n      }\n    });\n    return () => {\n      isMounted = false;\n      if (objectUrl) {\n        URL.revokeObjectURL(objectUrl);\n      }\n    };\n  }, [item.snapshot_url]);\n  const previewLink = previewUrl || snapshotHref;\n  const showPreview = previewState === 'loading' || previewState === 'ready';\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card media-result-card\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"media-result-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"media-pill\",\n          children: [(_item$media_type = item.media_type) === null || _item$media_type === void 0 ? void 0 : _item$media_type.toUpperCase(), \" \\xB7 \", item.source_type]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: item.dominant_emotion\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"media-confidence\",\n          children: [\"Confianza \", (item.confidence * 100).toFixed(2), \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"media-links\",\n        children: [previewLink && /*#__PURE__*/_jsxDEV(\"a\", {\n          href: previewLink,\n          target: \"_blank\",\n          rel: \"noreferrer\",\n          children: \"Ver captura\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 13\n        }, this), originalHref && /*#__PURE__*/_jsxDEV(\"a\", {\n          href: originalHref,\n          target: \"_blank\",\n          rel: \"noreferrer\",\n          children: \"Archivo original\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), showPreview && /*#__PURE__*/_jsxDEV(\"figure\", {\n      className: `media-result-preview ${previewState === 'loading' ? 'is-loading' : ''}`,\n      children: previewState === 'ready' && previewUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n        src: previewUrl,\n        alt: `Captura del rostro clasificado como ${item.dominant_emotion}`,\n        loading: \"lazy\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"media-preview-skeleton\",\n        children: \"Renderizando captura\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }, this), counts.length > 0 && /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"media-counts\",\n      children: counts.map(([label, qty]) => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: qty\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 15\n        }, this)]\n      }, label, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      className: \"media-result-footer\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: item.created_at ? new Date(item.created_at).toLocaleString() : 'N/D'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"Canal: \", item.channel]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n}\n_s(MediaResultCard, \"v69MLYoApDRWEY8XN07BC4mQ+5c=\");\n_c = MediaResultCard;\nexport default MediaResultCard;\nvar _c;\n$RefreshReg$(_c, \"MediaResultCard\");","map":{"version":3,"names":["useEffect","useState","API_BASE_URL","fetchMediaSnapshot","jsxDEV","_jsxDEV","MediaResultCard","item","_s","_item$detections","_item$media_type","baseUrl","replace","buildUrl","path","startsWith","snapshotHref","snapshot_url","originalHref","original_url","counts","Object","entries","detections","previewUrl","setPreviewUrl","previewState","setPreviewState","isMounted","objectUrl","then","blob","URL","createObjectURL","catch","revokeObjectURL","previewLink","showPreview","className","children","media_type","toUpperCase","source_type","fileName","_jsxFileName","lineNumber","columnNumber","dominant_emotion","confidence","toFixed","href","target","rel","src","alt","loading","length","map","label","qty","created_at","Date","toLocaleString","channel","_c","$RefreshReg$"],"sources":["C:/Users/Loq/Desktop/gatoportafolio/EmocionesDos - versioncuatroedit01/SIMPACedit/frontend/src/components/MediaResultCard.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\n\r\nimport { API_BASE_URL } from '../services/api.js';\r\nimport { fetchMediaSnapshot } from '../services/mediaService.js';\r\n\r\nfunction MediaResultCard({ item }) {\r\n  const baseUrl = API_BASE_URL.replace(/\\/$/, '');\r\n  const buildUrl = (path) => {\r\n    if (!path) return null;\r\n    if (path.startsWith('http')) return path;\r\n    return `${baseUrl}${path}`;\r\n  };\r\n\r\n  const snapshotHref = buildUrl(item.snapshot_url);\r\n  const originalHref = buildUrl(item.original_url);\r\n  const counts = Object.entries(item.detections?.counts || {});\r\n  const [previewUrl, setPreviewUrl] = useState(null);\r\n  const [previewState, setPreviewState] = useState(item.snapshot_url ? 'loading' : 'idle');\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    let objectUrl = null;\r\n\r\n    if (!item.snapshot_url) {\r\n      setPreviewUrl(null);\r\n      setPreviewState('idle');\r\n      return () => {};\r\n    }\r\n\r\n    setPreviewState('loading');\r\n    fetchMediaSnapshot(item.snapshot_url)\r\n      .then((blob) => {\r\n        if (!blob || !isMounted) {\r\n          return;\r\n        }\r\n        objectUrl = URL.createObjectURL(blob);\r\n        setPreviewUrl(objectUrl);\r\n        setPreviewState('ready');\r\n      })\r\n      .catch(() => {\r\n        if (isMounted) {\r\n          setPreviewState('error');\r\n        }\r\n      });\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      if (objectUrl) {\r\n        URL.revokeObjectURL(objectUrl);\r\n      }\r\n    };\r\n  }, [item.snapshot_url]);\r\n\r\n  const previewLink = previewUrl || snapshotHref;\r\n  const showPreview = previewState === 'loading' || previewState === 'ready';\r\n\r\n  return (\r\n    <div className=\"card media-result-card\">\r\n      <header className=\"media-result-header\">\r\n        <div>\r\n          <p className=\"media-pill\">{item.media_type?.toUpperCase()} · {item.source_type}</p>\r\n          <h3>{item.dominant_emotion}</h3>\r\n          <p className=\"media-confidence\">Confianza {(item.confidence * 100).toFixed(2)}%</p>\r\n        </div>\r\n        <div className=\"media-links\">\r\n          {previewLink && (\r\n            <a href={previewLink} target=\"_blank\" rel=\"noreferrer\">\r\n              Ver captura\r\n            </a>\r\n          )}\r\n          {originalHref && (\r\n            <a href={originalHref} target=\"_blank\" rel=\"noreferrer\">\r\n              Archivo original\r\n            </a>\r\n          )}\r\n        </div>\r\n      </header>\r\n      {showPreview && (\r\n        <figure className={`media-result-preview ${previewState === 'loading' ? 'is-loading' : ''}`}>\r\n          {previewState === 'ready' && previewUrl ? (\r\n            <img src={previewUrl} alt={`Captura del rostro clasificado como ${item.dominant_emotion}`} loading=\"lazy\" />\r\n          ) : (\r\n            <div className=\"media-preview-skeleton\">Renderizando captura…</div>\r\n          )}\r\n        </figure>\r\n      )}\r\n      {counts.length > 0 && (\r\n        <ul className=\"media-counts\">\r\n          {counts.map(([label, qty]) => (\r\n            <li key={label}>\r\n              <span>{label}</span>\r\n              <strong>{qty}</strong>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n      <footer className=\"media-result-footer\">\r\n        <span>{item.created_at ? new Date(item.created_at).toLocaleString() : 'N/D'}</span>\r\n        <span>Canal: {item.channel}</span>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MediaResultCard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
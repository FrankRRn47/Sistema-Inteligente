{"ast":null,"code":"import{useEffect,useMemo,useState}from'react';import{API_BASE_URL}from'../services/api.js';import{fetchMediaSnapshot}from'../services/mediaService.js';const API_ROOT=API_BASE_URL.replace(/\\/$/,'');function buildAbsoluteUrl(path){if(!path){return null;}if(path.startsWith('http')){return path;}if(path.startsWith('/')){return\"\".concat(API_ROOT).concat(path);}return\"\".concat(API_ROOT,\"/\").concat(path);}export default function useSnapshotPreview(snapshotPath){const[previewUrl,setPreviewUrl]=useState(null);const[state,setState]=useState(snapshotPath?'loading':'idle');const fallbackUrl=useMemo(()=>buildAbsoluteUrl(snapshotPath),[snapshotPath]);useEffect(()=>{let isMounted=true;let objectUrl=null;if(!snapshotPath){setPreviewUrl(null);setState('idle');return()=>{};}setState('loading');fetchMediaSnapshot(snapshotPath).then(blob=>{if(!blob||!isMounted){return;}objectUrl=URL.createObjectURL(blob);setPreviewUrl(objectUrl);setState('ready');}).catch(()=>{if(isMounted){setState('error');}});return()=>{isMounted=false;if(objectUrl){URL.revokeObjectURL(objectUrl);}};},[snapshotPath]);return{previewUrl,fallbackUrl,state};}","map":{"version":3,"names":["useEffect","useMemo","useState","API_BASE_URL","fetchMediaSnapshot","API_ROOT","replace","buildAbsoluteUrl","path","startsWith","concat","useSnapshotPreview","snapshotPath","previewUrl","setPreviewUrl","state","setState","fallbackUrl","isMounted","objectUrl","then","blob","URL","createObjectURL","catch","revokeObjectURL"],"sources":["C:/Users/Loq/Desktop/gatoportafolio/EmocionesDos - versioncuatroedit01 - 100% funcional - vedit/SIMPACeditDos/frontend/src/hooks/useSnapshotPreview.js"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\r\n\r\nimport { API_BASE_URL } from '../services/api.js';\r\nimport { fetchMediaSnapshot } from '../services/mediaService.js';\r\n\r\nconst API_ROOT = API_BASE_URL.replace(/\\/$/, '');\r\n\r\nfunction buildAbsoluteUrl(path) {\r\n  if (!path) {\r\n    return null;\r\n  }\r\n  if (path.startsWith('http')) {\r\n    return path;\r\n  }\r\n  if (path.startsWith('/')) {\r\n    return `${API_ROOT}${path}`;\r\n  }\r\n  return `${API_ROOT}/${path}`;\r\n}\r\n\r\nexport default function useSnapshotPreview(snapshotPath) {\r\n  const [previewUrl, setPreviewUrl] = useState(null);\r\n  const [state, setState] = useState(snapshotPath ? 'loading' : 'idle');\r\n  const fallbackUrl = useMemo(() => buildAbsoluteUrl(snapshotPath), [snapshotPath]);\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    let objectUrl = null;\r\n\r\n    if (!snapshotPath) {\r\n      setPreviewUrl(null);\r\n      setState('idle');\r\n      return () => {};\r\n    }\r\n\r\n    setState('loading');\r\n    fetchMediaSnapshot(snapshotPath)\r\n      .then((blob) => {\r\n        if (!blob || !isMounted) {\r\n          return;\r\n        }\r\n        objectUrl = URL.createObjectURL(blob);\r\n        setPreviewUrl(objectUrl);\r\n        setState('ready');\r\n      })\r\n      .catch(() => {\r\n        if (isMounted) {\r\n          setState('error');\r\n        }\r\n      });\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      if (objectUrl) {\r\n        URL.revokeObjectURL(objectUrl);\r\n      }\r\n    };\r\n  }, [snapshotPath]);\r\n\r\n  return { previewUrl, fallbackUrl, state };\r\n}\r\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,OAAO,CAAEC,QAAQ,KAAQ,OAAO,CAEpD,OAASC,YAAY,KAAQ,oBAAoB,CACjD,OAASC,kBAAkB,KAAQ,6BAA6B,CAEhE,KAAM,CAAAC,QAAQ,CAAGF,YAAY,CAACG,OAAO,CAAC,KAAK,CAAE,EAAE,CAAC,CAEhD,QAAS,CAAAC,gBAAgBA,CAACC,IAAI,CAAE,CAC9B,GAAI,CAACA,IAAI,CAAE,CACT,MAAO,KAAI,CACb,CACA,GAAIA,IAAI,CAACC,UAAU,CAAC,MAAM,CAAC,CAAE,CAC3B,MAAO,CAAAD,IAAI,CACb,CACA,GAAIA,IAAI,CAACC,UAAU,CAAC,GAAG,CAAC,CAAE,CACxB,SAAAC,MAAA,CAAUL,QAAQ,EAAAK,MAAA,CAAGF,IAAI,EAC3B,CACA,SAAAE,MAAA,CAAUL,QAAQ,MAAAK,MAAA,CAAIF,IAAI,EAC5B,CAEA,cAAe,SAAS,CAAAG,kBAAkBA,CAACC,YAAY,CAAE,CACvD,KAAM,CAACC,UAAU,CAAEC,aAAa,CAAC,CAAGZ,QAAQ,CAAC,IAAI,CAAC,CAClD,KAAM,CAACa,KAAK,CAAEC,QAAQ,CAAC,CAAGd,QAAQ,CAACU,YAAY,CAAG,SAAS,CAAG,MAAM,CAAC,CACrE,KAAM,CAAAK,WAAW,CAAGhB,OAAO,CAAC,IAAMM,gBAAgB,CAACK,YAAY,CAAC,CAAE,CAACA,YAAY,CAAC,CAAC,CAEjFZ,SAAS,CAAC,IAAM,CACd,GAAI,CAAAkB,SAAS,CAAG,IAAI,CACpB,GAAI,CAAAC,SAAS,CAAG,IAAI,CAEpB,GAAI,CAACP,YAAY,CAAE,CACjBE,aAAa,CAAC,IAAI,CAAC,CACnBE,QAAQ,CAAC,MAAM,CAAC,CAChB,MAAO,IAAM,CAAC,CAAC,CACjB,CAEAA,QAAQ,CAAC,SAAS,CAAC,CACnBZ,kBAAkB,CAACQ,YAAY,CAAC,CAC7BQ,IAAI,CAAEC,IAAI,EAAK,CACd,GAAI,CAACA,IAAI,EAAI,CAACH,SAAS,CAAE,CACvB,OACF,CACAC,SAAS,CAAGG,GAAG,CAACC,eAAe,CAACF,IAAI,CAAC,CACrCP,aAAa,CAACK,SAAS,CAAC,CACxBH,QAAQ,CAAC,OAAO,CAAC,CACnB,CAAC,CAAC,CACDQ,KAAK,CAAC,IAAM,CACX,GAAIN,SAAS,CAAE,CACbF,QAAQ,CAAC,OAAO,CAAC,CACnB,CACF,CAAC,CAAC,CAEJ,MAAO,IAAM,CACXE,SAAS,CAAG,KAAK,CACjB,GAAIC,SAAS,CAAE,CACbG,GAAG,CAACG,eAAe,CAACN,SAAS,CAAC,CAChC,CACF,CAAC,CACH,CAAC,CAAE,CAACP,YAAY,CAAC,CAAC,CAElB,MAAO,CAAEC,UAAU,CAAEI,WAAW,CAAEF,KAAM,CAAC,CAC3C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}